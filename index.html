<!DOCTYPE html>
<html>
<head>
  <title>ISL Continuous Translator</title>

  <style>
    body { text-align: center; font-family: Arial; }
    video { border: 2px solid black; }
    #output { font-size: 28px; margin-top: 15px; color: green; }
    button { font-size: 16px; padding: 10px 20px; margin: 10px; }
  </style>
</head>

<body>

<h2>Indian Sign Language Translator</h2>

<video id="video" width="640" height="480" autoplay></video>

<div>
  <button onclick="start()">Start</button>
  <button onclick="stop()">Stop</button>
</div>

<div id="output">Idle</div>

<script>
const video = document.getElementById("video");
const output = document.getElementById("output");

navigator.mediaDevices.getUserMedia({ video: true })
  .then(stream => video.srcObject = stream);

const ws = new WebSocket("ws://localhost:8000/ws");

ws.onmessage = (event) => {
  output.innerText = event.data;
};

function start() {
  ws.send("START");
  output.innerText = "Listening...";
}

function stop() {
  ws.send("STOP");
  output.innerText = "Stopped";
}

function sendFrame() {
  if (ws.readyState !== WebSocket.OPEN) return;

  const canvas = document.createElement("canvas");
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;

  const ctx = canvas.getContext("2d");
  ctx.drawImage(video, 0, 0);

  canvas.toBlob(blob => {
    if (!blob) return;
    blob.arrayBuffer().then(buffer => ws.send(buffer));
  }, "image/jpeg", 0.7);
}

// ~6â€“7 FPS
setInterval(sendFrame, 150);
</script>

</body>
</html>
